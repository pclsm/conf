# HTTP ä»£ç†ç«¯å£
# port: 7890

# SOCKS5 ä»£ç†ç«¯å£
# socks-port: 7891

# Linux å’Œ macOS çš„ redir é€æ˜ä»£ç†ç«¯å£ (é‡å®šå‘ TCP å’Œ TProxy UDP æµé‡)
# redir-port: 7892

# Linux çš„é€æ˜ä»£ç†ç«¯å£ï¼ˆé€‚ç”¨äº TProxy TCP å’Œ TProxy UDP æµé‡)
# tproxy-port: 7893

# HTTP(S) and SOCKS5 å…±ç”¨ç«¯å£
mixed-port: 7890

# æœ¬åœ° SOCKS5/HTTP(S) æœåŠ¡éªŒè¯
# authentication:
#  - "user1:pass1"
#  - "user2:pass2"

# å…è®¸å±€åŸŸç½‘çš„è¿æ¥ï¼ˆå¯ç”¨æ¥å…±äº«ä»£ç†ï¼‰
allow-lan: true
bind-address: "*"
# æ­¤åŠŸèƒ½ä»…åœ¨ allow-lan è®¾ç½®ä¸º true æ—¶ç”Ÿæ•ˆï¼Œæ”¯æŒä¸‰ç§å‚æ•°ï¼š
# "*"                           ç»‘å®šæ‰€æœ‰çš„ IP åœ°å€
# 192.168.122.11                ç»‘å®šä¸€ä¸ªçš„ IPv4 åœ°å€
# "[aaaa::a8aa:ff:fe09:57d8]"   ç»‘å®šä¸€ä¸ª IPv6 åœ°å€

# Clash è·¯ç”±å·¥ä½œæ¨¡å¼
# è§„åˆ™æ¨¡å¼ï¼šruleï¼ˆè§„åˆ™ï¼‰ / globalï¼ˆå…¨å±€ä»£ç†ï¼‰/ directï¼ˆå…¨å±€ç›´è¿ï¼‰
mode: rule

# Clash é»˜è®¤å°†æ—¥å¿—è¾“å‡ºè‡³ STDOUT
# è®¾ç½®æ—¥å¿—è¾“å‡ºçº§åˆ« (é»˜è®¤çº§åˆ«ï¼šsilentï¼Œå³ä¸è¾“å‡ºä»»ä½•å†…å®¹ï¼Œä»¥é¿å…å› æ—¥å¿—å†…å®¹è¿‡å¤§è€Œå¯¼è‡´ç¨‹åºå†…å­˜æº¢å‡ºï¼‰ã€‚
# 5 ä¸ªçº§åˆ«ï¼šsilent / info / warning / error / debugã€‚çº§åˆ«è¶Šé«˜æ—¥å¿—è¾“å‡ºé‡è¶Šå¤§ï¼Œè¶Šå€¾å‘äºè°ƒè¯•ï¼Œè‹¥éœ€è¦è¯·è‡ªè¡Œå¼€å¯ã€‚
log-level: info

# clash çš„ RESTful API ç›‘å¬åœ°å€
external-controller: 127.0.0.1:9090

# å­˜æ”¾é…ç½®æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ï¼Œæˆ–å­˜æ”¾ç½‘é¡µé™æ€èµ„æºçš„ç»å¯¹è·¯å¾„
# Clash core å°†ä¼šå°†å…¶éƒ¨ç½²åœ¨ http://{{external-controller}}/ui
# external-ui: folder

# RESTful API çš„å£ä»¤ (å¯é€‰)
# é€šè¿‡ HTTP å¤´ä¸­ Authorization: Bearer ${secret} å‚æ•°æ¥éªŒè¯å£ä»¤
# å½“ RESTful API çš„ç›‘å¬åœ°å€ä¸º 0.0.0.0 æ—¶ï¼Œè¯·åŠ¡å¿…è®¾å®šå£ä»¤ä»¥ä¿è¯å®‰å…¨
# secret: ""

# å‡ºç«™ç½‘å¡æ¥å£
# interface-name: en0

# DNS æœåŠ¡å™¨å’Œå»ºç«‹è¿æ¥æ—¶çš„ é™æ€ Hosts, ä»…åœ¨ dns.enhanced-mode æ¨¡å¼ä¸º redir-host ç”Ÿæ•ˆ
# æ”¯æŒé€šé…ç¬¦åŸŸå (ä¾‹å¦‚: *.clash.dev, *.foo.*.example.com )
# ä¸ä½¿ç”¨é€šé…ç¬¦çš„åŸŸåä¼˜å…ˆçº§é«˜äºä½¿ç”¨é€šé…ç¬¦çš„åŸŸå (ä¾‹å¦‚: foo.example.com > *.example.com > .example.com )
# æ³¨æ„: +.foo.com çš„æ•ˆæœç­‰åŒäº .foo.com å’Œ foo.com
hosts:
  # nas.onlymin.com: 192.168.80.12
  # vc.onlymin.com: 192.168.80.7
# '*.clash.dev': 127.0.0.1
# '.dev': 127.0.0.1
# 'alpha.clash.dev': '::1'

# DNS æœåŠ¡å™¨é…ç½®(å¯é€‰ï¼›è‹¥ä¸é…ç½®ï¼Œç¨‹åºå†…ç½®çš„ DNS æœåŠ¡ä¼šè¢«å…³é—­)
dns:
  enable: true
  listen: 0.0.0.0:53
  # å½“æ­¤é€‰é¡¹ä¸º false æ—¶, AAAA è¯·æ±‚å°†è¿”å›ç©º
  ipv6: true 
  # ä»¥ä¸‹å¡«å†™çš„ DNS æœåŠ¡å™¨å°†ä¼šè¢«ç”¨æ¥è§£æä¸‹é¢ nameserver åˆ—è¡¨ä¸­ DoH/DoT DNS æœåŠ¡å™¨çš„åŸŸå,ä»…æ”¯æŒ IP åœ°å€
  default-nameserver:
    - 8.8.8.8
    - 114.114.114.114
  enhanced-mode: redir-host # æˆ–  fake-ip
  fake-ip-range: 198.18.0.1/16 # Fake IP åœ°å€æ±  (CIDR å½¢å¼)

  # æŸ¥è¯¢ hosts å¹¶è¿”å› IP è®°å½•
  # use-hosts: true 

  # åœ¨ä»¥ä¸‹åˆ—è¡¨çš„åŸŸåå°†ä¸ä¼šè¢«è§£æä¸º fake ipï¼Œè¿™äº›åŸŸåç›¸å…³çš„è§£æè¯·æ±‚å°†ä¼šè¿”å›å®ƒä»¬çœŸå®çš„ IP åœ°å€
  # fake-ip-filter:
  #   - '*.lan'
  #   - localhost.ptlogin2.qq.com

  # æ”¯æŒ UDP / TCP / DoT / DoH åè®®çš„ DNS æœåŠ¡ï¼Œå¯ä»¥æŒ‡æ˜å…·ä½“çš„è¿æ¥ç«¯å£å·ã€‚
  # æ‰€æœ‰ DNS è¯·æ±‚å°†ä¼šç›´æ¥å‘é€åˆ°æœåŠ¡å™¨ï¼Œä¸ç»è¿‡ä»»ä½•ä»£ç†ã€‚
  # Clash ä¼šä½¿ç”¨æœ€å…ˆè·å¾—çš„è§£æè®°å½•å›å¤ DNS è¯·æ±‚
  nameserver:
    # - 192.168.80.53
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query

  # å½“ fallback å‚æ•°è¢«é…ç½®æ—¶, DNS è¯·æ±‚å°†åŒæ—¶å‘é€è‡³ä¸Šæ–¹ nameserver åˆ—è¡¨å’Œä¸‹æ–¹ fallback åˆ—è¡¨ä¸­é…ç½®çš„æ‰€æœ‰ DNS æœåŠ¡å™¨.
  # å½“è§£æå¾—åˆ°çš„ IP åœ°å€çš„åœ°ç†ä½ç½®ä¸æ˜¯ CN æ—¶ï¼Œclash å°†ä¼šé€‰ç”¨ fallback ä¸­ DNS æœåŠ¡å™¨çš„è§£æç»“æœã€‚
  fallback:
    - https://dns.google/dns-query

  # å¦‚æœä½¿ç”¨ nameserver åˆ—è¡¨ä¸­çš„æœåŠ¡å™¨è§£æçš„ IP åœ°å€åœ¨ä¸‹æ–¹åˆ—è¡¨ä¸­çš„å­ç½‘ä¸­ï¼Œåˆ™å®ƒä»¬è¢«è®¤ä¸ºæ˜¯æ— æ•ˆçš„ï¼ŒClash ä¼šé€‰ç”¨ fallback åˆ—è¡¨ä¸­é…ç½® DNS æœåŠ¡å™¨è§£æå¾—åˆ°çš„ç»“æœã€‚
  # å½“ fallback-filter.geoip ä¸º true ä¸” IP åœ°å€çš„åœ°ç†ä½ç½®ä¸º CN æ—¶ï¼ŒClash ä¼šé€‰ç”¨ nameserver åˆ—è¡¨ä¸­ DNS æœåŠ¡å™¨è§£æå¾—åˆ°çš„ç»“æœã€‚
  # å½“ fallback-filter.geoip ä¸º false, å¦‚æœè§£æç»“æœä¸åœ¨ fallback-filter.ipcidr èŒƒå›´å†…ï¼ŒClash ä¼šé€‰ç”¨ nameserver åˆ—è¡¨ä¸­ DNS æœåŠ¡å™¨è§£æå¾—åˆ°çš„ç»“æœã€‚
  # é‡‡å–ä»¥ä¸Šé€»è¾‘è¿›è¡ŒåŸŸåè§£ææ˜¯ä¸ºäº†å¯¹æŠ— DNS æŠ•æ¯’æ”»å‡»ã€‚
  fallback-filter:
    geoip: false
    ipcidr:
      - 240.0.0.0/4
      - 0.0.0.0/32
    # domain:
    #   - '+.google.com'
    #   - '+.facebook.com'
    #   - '+.youtube.com'

proxy-providers:
  vps:
    type: file
    path: ./proxy-providers/vps.yaml
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300
  jms:
    type: file
    path: ./proxy-providers/jms.yaml
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300

proxies:
  # - name: JMS-1
  #   server: 96.45.178.134
  #   port: 11573
  #   type: ss
  #   cipher: aes-256-gcm
  #   password: AKWCwXxDbh

  # - name: JMS-2
  #   server: 144.34.184.27
  #   port: 11573
  #   type: ss
  #   cipher: aes-256-gcm
  #   password: AKWCwXxDbh

proxy-groups:
# å›½å†…ğŸŒ
# å›½å¤–ğŸŒ    
# ğŸ”° â™»ï¸ â“‚ï¸ ğŸ¯ ğŸ›‘ ğŸ ğŸ’» ğŸ“½ ğŸ¬ ğŸ“º ğŸ•¹ ğŸš« ğŸš¦ ï£¿ ğŸ¼ ğŸŸ ğŸµ ğŸ¸ ğŸ‡¨ğŸ‡³ ğŸŒ â›”ï¸ ğŸ‡¨ğŸ‡³ ğŸ‡ºğŸ‡¸ ğŸ‡­ğŸ‡° ğŸ§­ ğŸŒ‘ ğŸ§¯ ğŸ•¹ ğŸ ğŸ¦† ğŸ›¡
  - name: â™»ï¸ è‡ªåŠ¨é€‰æ‹©
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    use:
      - jms

  - name: ğŸ’» ä»£ç†èŠ‚ç‚¹
    type: select
    proxies:
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
    use:
      - jms
      - vps

  - name: ğŸŒ å›½å¤–ç«™ç‚¹
    type: select
    proxies:
      - ğŸ’» ä»£ç†èŠ‚ç‚¹
      - DIRECT

  - name: ğŸ è‹¹æœç½‘ç«™
    type: select
    proxies:
      - ğŸ’» ä»£ç†èŠ‚ç‚¹
      - DIRECT

  - name: ğŸ‡¨ğŸ‡³ å›½å†…ç«™ç‚¹
    type: select
    proxies:
      - ğŸ’» ä»£ç†èŠ‚ç‚¹
      - DIRECT

  - name: ğŸŸ é»˜è®¤è§„åˆ™
    type: select
    proxies:
      - ğŸ’» ä»£ç†èŠ‚ç‚¹
      - DIRECT

# ä»£ç†è§„åˆ™æä¾›è€…
rule-providers:
  apple:
    type: file
    behavior: domain
    path: ./rule-set/apple.yaml

  icloud:
    type: file
    behavior: domain
    path: ./rule-set/icloud.yaml

  direct:
    type: file
    behavior: domain
    path: ./rule-set/direct.yaml

  proxy:
    type: file
    behavior: domain
    path: ./rule-set/proxy.yaml

  private:
    # å¯ä»¥æ˜¯ http æˆ– file
    type: file
    # domain ã€ ipcidr æˆ– classical
    behavior: domain
    # ä»…åœ¨ç±»å‹ä¸º HTTPï¼ˆå¯åœ¨æ­¤å¤„ä¸‹è½½æ–‡ä»¶ï¼‰æ—¶å¯ç”¨ã€‚ æ‚¨æ— éœ€åœ¨æœ¬åœ°ç©ºé—´ä¸­åˆ›å»ºæ–°æ–‡ä»¶
    # url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/icloud.yaml"
    # æœ¬åœ°æ–‡ä»¶è·¯å¾„
    path: ./rule-set/private.yaml
    # è‡ªåŠ¨æ›´æ–°é—´éš”ï¼Œä»…åœ¨ HTTP æ—¶å¯ç”¨
    # interval: 86400
    # å¥åº·æ£€æŸ¥
    # health-check: 
      # å¯ç”¨è¿è¡ŒçŠ¶å†µæ£€æŸ¥é€‰é¡¹
      # enable: true
      # ç”¨äºå¥åº·æ£€æŸ¥çš„ç½‘å€
      # url: 
      # æ£€æŸ¥æ—¶é—´é—´éš”
      # interval: 86400

  lancidr:
    type: file
    behavior: ipcidr
    path: ./rule-set/lancidr.yaml
  
rules:
  # å±€åŸŸç½‘ IP åŠä¿ç•™ IP åœ°å€åˆ—è¡¨
  - RULE-SET,lancidr,DIRECT
  # ç§æœ‰ç½‘ç»œä¸“ç”¨åŸŸååˆ—è¡¨
  - RULE-SET,private,DIRECT

  # Apple
  - RULE-SET,apple,ğŸ è‹¹æœç½‘ç«™
  # iCloud 
  - RULE-SET,icloud,ğŸ è‹¹æœç½‘ç«™
  # å›½å¤–ç«™ç‚¹
  - RULE-SET,proxy,ğŸŒ å›½å¤–ç«™ç‚¹
  # å›½å†…ç›´è¿åŸŸååˆ—è¡¨
  - RULE-SET,direct,ğŸ‡¨ğŸ‡³ å›½å†…ç«™ç‚¹

# å•æ¡è§„åˆ™æ ¼å¼
  # åŸŸåå®Œå…¨åŒ¹é…
  # - DOMAIN,ad.com,REJECT
  # åŸŸååç¼€åŒ¹é…
  # - DOMAIN-SUFFIX,google.com,auto
  # åŸŸåå…³é”®å­—åŒ¹é…
  # - DOMAIN-KEYWORD,google,auto
  # å¦‚æœè¯·æ±‚çš„å®¢æˆ·ç«¯IPåœ°å€åŒ¹é…ï¼Œåˆ™è§„åˆ™åŒ¹é…
  # - SRC-IP-CIDR,192.168.1.201/32,DIRECT
  # å¦‚æœè¯·æ±‚çš„IPåœ°å€åŒ¹é…æŒ‡å®šèŒƒå›´ï¼Œåˆ™è§„åˆ™åŒ¹é…
  # - IP-CIDR,127.0.0.0/8,DIRECT
  # - IP-CIDR6,2620:0:2d0:200::7/32,auto
  # - DST-PORT,80,DIRECT
  # - SRC-PORT,7777,DIRECT
  # å¦‚æœ GeoIP ç»“æœä¸æŒ‡å®šå›½å®¶/åœ°åŒºä»£ç åŒ¹é…ï¼Œåˆ™è§„åˆ™åŒ¹é…ã€‚
  # é‡åˆ°GEOIPæˆ–IP-CIDRè§„åˆ™æ—¶ï¼ŒClashå°†å‘é€DNSé—®é¢˜ï¼Œä»¥æ£€æŸ¥è¯·æ±‚çš„ä¸»æœºåæ˜¯å¦ä¸ºåŸŸã€‚
  # å¯ä»¥é€‰æ‹©'no-resolve'é€‰é¡¹ï¼Œä»¥è·³è¿‡é’ˆå¯¹å…·æœ‰åŸŸè¯·æ±‚çš„è§„åˆ™ã€‚
  - GEOIP,CN,ğŸ‡¨ğŸ‡³ å›½å†…ç«™ç‚¹
  # åŒ¹é…è§„åˆ™å¿…é¡»å†™åœ¨æ‰€æœ‰å…¶ä»–è§„åˆ™ä¹‹åã€‚ å®ƒä¸ºæœªä¸å…¶ä»–ä»»ä½•è§„åˆ™åŒ¹é…çš„è¯·æ±‚å®šä¹‰é»˜è®¤ç­–ç•¥ã€‚
  - MATCH,ğŸŸ é»˜è®¤è§„åˆ™